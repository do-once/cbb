{"version":3,"file":"dom.js","sourceRoot":"","sources":["../src/dom.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @author GuangHui\n * @description dom 操作相关\n */\n\nimport { str2kebab } from './tools'\nimport { isEmpty } from './type-judge'\n\n/**\n * 添加样式类\n * @param {Element} el 元素\n * @param {String} className 样式名\n */\nexport function addClass(el: HTMLElement, className: string) {\n  if (hasClass(el, className)) {\n    return\n  }\n  const newClass = el.className.split(' ')\n  newClass.push(className)\n  el.className = newClass.join(' ')\n}\n\n/**\n * 移除样式类\n * @param {Element} el 元素\n * @param {String} className 样式名\n */\nexport function removeClass(el: HTMLElement, className: string) {\n  if (!hasClass(el, className)) {\n    return\n  }\n  const newClassList = el.className.split(' ')\n  newClassList.splice(newClassList.indexOf(className), 1)\n  el.className = newClassList.join(' ')\n}\n\n/**\n * 判断是否有样式类\n * @param {Element} el 元素\n * @param {String} className 样式类\n */\nexport function hasClass(el: HTMLElement, className: string) {\n  const reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)')\n  return reg.test(el.className)\n}\n\n/**\n * 获取/设置data-*\n * @param {Element} el 元素\n * @param {String} name 名称\n * @param {Any} val 需要设置的值\n */\nexport function getData(el: HTMLElement, name: string, val: any) {\n  const prefix = 'data-'\n  name = prefix + name\n  if (val) {\n    return el.setAttribute(name, val)\n  } else {\n    return el.getAttribute(name)\n  }\n}\n\n/**\n * 获取元素尺寸\n * @param {Element} el 元素\n */\nexport function getRect(el: HTMLElement) {\n  if (el instanceof window.SVGElement) {\n    const rect = el.getBoundingClientRect()\n    return {\n      top: rect.top,\n      left: rect.left,\n      width: rect.width,\n      height: rect.height\n    }\n  } else {\n    return {\n      top: el.offsetTop,\n      left: el.offsetLeft,\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\n/**\n * 复制到剪贴板\n * @param {String} str 需要复制的字符串\n */\nexport function copyToClipboard(str: string) {\n  const el = document.createElement('textarea')\n  el.value = str\n  el.setAttribute('readonly', '')\n  el.style.position = 'absolute'\n  el.style.left = '-9999px'\n  document.body.appendChild(el)\n  const selected = document.getSelection()!.rangeCount > 0 ? document.getSelection()!.getRangeAt(0) : false\n  el.select()\n  document.execCommand('copy')\n  document.body.removeChild(el)\n  if (selected) {\n    document.getSelection()!.removeAllRanges()\n    document.getSelection()!.addRange(selected)\n  }\n}\n\n/**\n * 滚动html到顶部\n */\nexport function scrollToTop() {\n  const c = document.documentElement.scrollTop || document.body.scrollTop\n  if (c > 0) {\n    window.requestAnimationFrame(scrollToTop)\n    window.scrollTo(0, c - c / 8)\n  }\n}\n\n/**\n * 获取计算样式\n * @param {Object} el\n * @returns {Object} 样式对象\n */\nexport function getStyle(el: HTMLElement) {\n  // * 使用defaultView兼容FF<=30中出现的问题\n  var view = el.ownerDocument.defaultView\n\n  if (!view || !view.opener) {\n    view = window\n  }\n\n  return view.getComputedStyle(el, null)\n}\n\n/**\n * 添加样式\n * @param {Element} el 元素\n * @param {Object} styleObj 样式obj\n */\nexport function addStyle(el: HTMLElement, styleObj: any) {\n  const oldStyle = el.style.cssText\n\n  const newStyle = Object.entries(styleObj).reduce((acc, cur) => {\n    cur[0] = str2kebab(cur[0]) // key转换成kebab-case\n    return (acc += cur.join(':') + ';')\n  }, oldStyle)\n\n  el.style.cssText = newStyle\n}\n\n/**\n * 判断是否支持css3 变量\n *\n * @export\n * @returns 是否支持\n */\nexport const canSupportCssVar: {\n  (): boolean\n  isSupport?: boolean\n} = () => {\n  if (canSupportCssVar.isSupport != null) return canSupportCssVar.isSupport\n\n  const id = 'test-support-css-var'\n  let styleEl = document.createElement('style')\n  styleEl.innerText =\n    styleEl.innerText = `:root{--${id}:-9999;}#${id}{position:absolute;top:-99999em;left:-99999em;z-index:var(--${id});opacity:0;font-size:0;width:0;height:0;pointer-events: none;}`\n\n  document.head.appendChild(styleEl)\n\n  let testSpan = document.createElement('span')\n  testSpan.id = id\n\n  document.body.appendChild(testSpan)\n\n  const styleObj = getStyle(testSpan)\n\n  const isSupport = !!styleObj && styleObj.zIndex === '-9999'\n\n  document.head.removeChild(styleEl)\n  document.body.removeChild(testSpan)\n  styleEl = null as unknown as HTMLStyleElement\n  testSpan = null as unknown as HTMLSpanElement\n\n  canSupportCssVar.isSupport = isSupport\n\n  return isSupport\n}\n\n/**\n * 查看某元素是否命中css选择器字符串\n * https://developer.mozilla.org/zh-CN/docs/Web/API/Element/matches\n * https://blog.csdn.net/king_xing/article/details/50460580\n *\n * @export\n * @param {Element} el 需要检测的el\n * @param {String} selector css选择器字符串\n * @returns 是否命中\n */\nexport function matches(el: HTMLElement, selector: string) {\n  const fn =\n    Element.prototype.matches ||\n    // @ts-ignore\n    Element.prototype.matchesSelector ||\n    // @ts-ignore\n    Element.prototype.mozMatchesSelector ||\n    // @ts-ignore\n    Element.prototype.msMatchesSelector ||\n    // @ts-ignore\n    Element.prototype.oMatchesSelector ||\n    Element.prototype.webkitMatchesSelector ||\n    function (s) {\n      // @ts-ignore\n      var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n        i = matches.length\n      // @ts-ignore\n      while (--i >= 0 && matches.item(i) !== this) {}\n      return i > -1\n    }\n\n  return fn.call(el, selector)\n}\n\n/**\n * 检查是否支持webp格式图片\n *\n * @export\n * @returns 是否支持webp\n */\nexport function supportWebp() {\n  try {\n    return document.createElement('canvas').toDataURL('image/webp').indexOf('data:image/webp') === 0\n  } catch (err) {\n    return false\n  }\n}\n\n/**\n * 生成svg文本\n *\n * @export\n * @param {*} [{\n *   width = 300,\n *   height = 150,\n *   fontSize = 14,\n *   fontFamily = 'system-ui, sans-serif',\n *   color = '#a2a9b6',\n *   opacity = 1,\n *   x = 50,\n *   y = 50,\n *   content = 'svg测试文本',\n *   transform = 'rotate(0,0,0)'\n * }={}]\n * @return {String} svg字符串（未转义）\n */\nexport function genSvgText({\n  width = 300,\n  height = 150,\n  fontSize = 14,\n  fontFamily = 'system-ui, sans-serif',\n  color = '#a2a9b6',\n  opacity = 1,\n  x = 50,\n  y = 50,\n  content = 'svg测试文本',\n  rotate = 0\n} = {}) {\n  const size = width === 300 && height === 150 ? '' : ` width=\"${width}\" height=\"${height}\"`\n\n  const fill = color === '#000000' || color === '#000' ? '' : ` fill=\"${color}\"`\n\n  const fillOpacity = opacity === 1 ? '' : ` fill-opacity=\"${opacity}\"`\n\n  const fontF = fontFamily ? ` font-family=\"${fontFamily}\"` : ''\n\n  // 旋转除2参考：https://www.zhangxinxu.com/wordpress/2015/10/understand-svg-transform/\n  const transformAttr = rotate && size ? ` transform=\"rotate(${rotate}, ${width / 2} ,${height / 2})\"` : ''\n\n  return `<svg${size} xmlns=\"http://www.w3.org/2000/svg\"><text x=\"${x}%\" y=\"${y}%\" font-size=\"${fontSize}\"${fill}${fillOpacity}${fontF}${transformAttr} text-anchor=\"middle\" dominant-baseline=\"middle\">${content}</text></svg>`\n}\n\n/**\n * 安全转义svg字符串\n *\n * @export\n * @param {String} svg svg字符串\n * @return {String} 转移后的svg字符串\n */\nexport function escapeSvg(svg: string) {\n  return svg\n    .trim()\n    .trim()\n    .replace(/\\n/g, '')\n    .replace(/\"/g, \"'\")\n    .replace(/%/g, '%25')\n    .replace(/#/g, '%23')\n    .replace(/{/g, '%7B')\n    .replace(/}/g, '%7D')\n    .replace(/</g, '%3C')\n    .replace(/>/g, '%3E')\n}\n\n/**\n * 生成内联svg\n *\n * @export\n * @param {String} svg 未转义的svg字符串\n * @return {String} 转义后的内联svg字符串\n * 参考：\n * https://www.zhangxinxu.com/wordpress/2020/10/text-as-css-background-image/\n * https://www.zhangxinxu.com/wordpress/2015/10/understand-svg-transform/\n * https://www.zhangxinxu.com/wordpress/2018/08/css-svg-background-image-base64-encode/\n */\nexport function makeSvgInline(svg: string) {\n  return `data:image/svg+xml;utf8,${escapeSvg(svg)}`\n}\n\n/**\n * 生成水印svg(包含默认属性)\n *\n * @export\n * @param {Object} params\n * @return {String} 转义后的内联svg字符串\n */\nexport function watermarkSvg(params = {}) {\n  return makeSvgInline(\n    genSvgText({\n      rotate: -45,\n      width: 200,\n      height: 200,\n      opacity: 0.5,\n      content: '水印',\n      ...params\n    })\n  )\n}\n\n/**\n * 加载css\n *\n * @export\n * @param {String} href css地址\n * @param {Object} [options={ rel: 'stylesheet' }] 额外options\n * @return {Promise}  promise实例\n */\nexport function loadCss(href: string, options = { rel: 'stylesheet' }) {\n  return new Promise((resolve, reject) => {\n    if (typeof href !== 'string') return reject('must specify href(string)')\n\n    let link = document.createElement('link')\n    link.href = href\n\n    const op = Object.assign({}, { rel: 'stylesheet' }, options)\n    // @ts-ignore\n    !isEmpty(op) && Object.entries(op).forEach(([key, val]) => (link[key] = val))\n\n    document.head.appendChild(link)\n\n    link.onload = () => {\n      link = null as unknown as HTMLLinkElement\n      resolve(void 0)\n    }\n\n    link.onerror = () => {\n      document.head.removeChild(link)\n\n      link = null as unknown as HTMLLinkElement\n      reject(new Error(`load css failed:${href}`))\n    }\n  })\n}\n\n/**\n * 加载js\n *\n * @export\n * @param {String} src script地址\n * @param {Object} [options={ type: 'text/javascript' }] 额外options\n * @return {Promise}  promise实例\n */\nexport function loadJs(src: string, options = { type: 'text/javascript' }) {\n  return new Promise((resolve, reject) => {\n    if (typeof src !== 'string') return reject('must specify src(string)')\n\n    let script = document.createElement('script')\n    script.src = src\n\n    const op = Object.assign({}, { type: 'text/javascript' }, options)\n    // @ts-ignore\n    !isEmpty(op) && Object.entries(op).forEach(([key, val]) => (script[key] = val))\n\n    document.body.appendChild(script)\n\n    script.onload = () => {\n      script = null as unknown as HTMLScriptElement\n      resolve(void 0)\n    }\n\n    script.onerror = () => {\n      document.body.removeChild(script)\n      script = null as unknown as HTMLScriptElement\n\n      reject(new Error(`load js failed:${src}`))\n    }\n  })\n}\n"]}